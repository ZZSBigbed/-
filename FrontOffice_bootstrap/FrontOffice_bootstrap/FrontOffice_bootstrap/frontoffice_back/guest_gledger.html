<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
        <meta name="description" content="">
        <meta name="author" content="">

        <title>Chain Responsive Bootstrap3 Admin</title>

        <link href="../css/style.default.css" rel="stylesheet">
        <link href="../css/select2.css" rel="stylesheet" />
        <link href="../css/style.datatables.css" rel="stylesheet">
        <link href="../css/dataTables.responsive.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
        <script src="js/html5shiv.js"></script>
        <script src="js/respond.min.js"></script>
        <![endif]-->
        
        <link href="../css/frontoffice/datatable.css" rel="stylesheet">
        <style>
	        .dataTable .selected{ background:#FFFDDD;}
        </style>
        
    </head>

    <body>

		<div class="contentpanel contentpanel-mediamanager">
            <div class="media-options">
                <div class="pull-left">
                    <div class="btn-toolbar">
                        <div class="btn-group">
                            <button id="btnTest" class="btn btn-default btn-sm" type="button">Test</button>
                        </div>
                        <div class="btn-group">
                            <button id="btnEdit" class="btn btn-default btn-sm disabled" type="button"><i class="fa fa-envelope mr5"></i> 修改</button>
                            <button class="btn btn-default btn-sm disabled" type="button"><i class="fa fa-download mr5"></i> Download</button>
                        </div>
                        <div class="btn-group">
                            <button class="btn btn-default btn-sm disabled" type="button"><i class="fa fa-pencil mr5"></i> Edit</button>
                            <button class="btn btn-default btn-sm disabled" type="button"><i class="fa fa-trash-o mr5"></i> Delete</button>
                        </div>
                    </div><!-- btn-toolbar -->
                </div>
                <div class="pull-right">
                    工用域: 
                    <div class="btn-group media-option-group" data-toggle="buttons">
                        <label class="btn btn-default btn-sm active">
                          <input type="radio" name="options" id="opAll" checked> 全部客人
                        </label>
                        <label class="btn btn-default btn-sm">
                          <input type="radio" name="options" id="opDoc"> 修改预定
                        </label>
                        <label class="btn btn-default btn-sm">
                          <input type="radio" name="options" id="opImg"> 客人抵店
                        </label>
                        <label class="btn btn-default btn-sm">
                          <input type="radio" name="options" id="opVid"> 在住客人
                        </label>
                        <label class="btn btn-default btn-sm">
                          <input type="radio" name="options" id="opAud"> 客人帐
                        </label>
                    </div><!-- btn-group -->
                </div>
            </div><!-- media-options -->
            
            <hr>
      
            <div class="row">
                  <div class="col-sm-9">
                    <div class="table-responsive">
                        <table id="tblGuest" class="table table-dark mb30 table-huasheng">
                            <thead>
                                <tr class="tt">
                                    <th ><input type="checkbox" id="chkAll" value="" /></th>
                                    <th>提示</th>
                                    <th>姓名</th>
                                    <th>房号</th>
                                    <th>房型</th>
                                    <th>抵店</th>
                                    <th>离店</th>
                                    <th>#</th>
                                    <th>状态</th>
                                    <th>房态</th>
                                    <th>房价</th>
                                    <th>包价</th>
                                    <th>预授权</th>
                                    <th>余额</th>
                                    <th>GNO</th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>                                
                   </div><!-- table-responsive -->
               </div><!-- col-sm-9 -->
            <div class="col-sm-4 col-md-3">
                <button class="btn btn-primary btn-block" id="btnSearch" >开始查询</button>
                <div class="mb20"></div>
                <div class="input-group">
                    <input type="search" class="form-control" placeholder= "模糊查询..." id="txtFuzzySearch">
                    <span class="input-group-addon"><i class="fa fa-search"></i></span>
                </div><!-- input-group -->
                <div class="mb20"></div>
                    <input type="text" class="form-control" id="txtRoom" placeholder="房号...">            
                <div class="mb20"></div>
                    <input type="text" class="form-control" id="txtGname" placeholder="姓名...">            
                <div class="mb20"></div>
    
                <div class="panel-group" id="accordion">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4 class="panel-title">
                                <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
                                    筛选条件 #1
                                </a>
                            </h4>
                        </div>
                        <div id="collapseOne" class="panel-collapse collapse in">
                            <div class="panel-body">
                                <div class="input-group">
                                    <div class="ckbox ckbox-warning">
                                        <input type="checkbox" id="checkboxWarning"/>
                                        <label for="checkboxWarning">本日预计离店</label>
                                    </div>
                                    <div class="ckbox ckbox-danger">
                                        <input type="checkbox" id="checkboxDanger" />
                                        <label for="checkboxDanger">已离店结账</label>
                                    </div>
                                    <div class="ckbox ckbox-primary">
                                        <input type="checkbox" value="1" id="checkboxPrimary"  />
                                        <label for="checkboxPrimary">在店和离店客人</label>
                                    </div>
                                    <div class="ckbox ckbox-success">
                                        <input type="checkbox" id="checkboxSuccess" />
                                        <label for="checkboxSuccess">不含假房</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><!-- panel -->
                    
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4 class="panel-title">
                                <a data-toggle="collapse" class="collapsed" data-parent="#accordion" href="#collapseTwo">
                                    筛选条件 #2
                                </a>
                            </h4>
                        </div>
                        <div id="collapseTwo" class="panel-collapse collapse">
                            <div class="panel-body">
                                <div class="input-group">
                                    <div class="ckbox ckbox-default">
                                        <input type="checkbox" value="1" id="checkboxDefault" />
                                        <label for="checkboxDefault">PX假房</label>
                                    </div>
                                    <div class="ckbox ckbox-default">
                                        <input type="checkbox" value="1" id="checkboxDefault"  />
                                        <label for="checkboxDefault">PF假房</label>
                                    </div>
                                    <div class="ckbox ckbox-default">
                                        <input type="checkbox" value="1" id="checkboxDefault"  />
                                        <label for="checkboxDefault">PM假房</label>
                                    </div>
                                    <div class="ckbox ckbox-default">
                                        <input type="checkbox" value="1" id="checkboxDefault"  />
                                        <label for="checkboxDefault">余额正+</label>
                                    </div>
                                    <div class="ckbox ckbox-default">
                                        <input type="checkbox" value="1" id="checkboxDefault"  />
                                        <label for="checkboxDefault">余额负-</label>
                                    </div>
                                    <div class="ckbox ckbox-default">
                                        <input type="checkbox" value="1" id="checkboxDefault"  />
                                        <label for="checkboxDefault">余额零</label>
                                    </div>
                                    <div class="ckbox ckbox-default">
                                        <input type="checkbox" value="1" id="checkboxDefault"  />
                                        <label for="checkboxDefault">预定有帐客人</label>
                                    </div>
                                 </div><!-- input-group -->
                            </div>
                        </div>
                    </div><!-- panel -->
                    
                </div><!-- panel-group -->
                <div class="mb20"></div>
                    <input type="text" class="form-control" id="txtCompany" placeholder="公司...">            
                <div class="mb20"></div>
                    <input type="text" class="form-control" id="txtParty" placeholder="小组...">            
                <div class="mb20"></div>
                    <input type="text" class="form-control" id="txtGroup" placeholder="团队...">            
                <br />
                            
            </div><!-- col-sm-4 -->                          
     	</div>
   	</div>
   
        <script src="../js/jquery-1.11.1.min.js"></script>
        <script src="../js/jquery-migrate-1.2.1.min.js"></script>
        <script src="../js/bootstrap.min.js"></script>
        
        <script src="../js/jquery.dataTables.min.js"></script>
        <script src="../js/dataTables.bootstrap.js"></script>
        <script src="../js/dataTables.responsive.js"></script>
        <script src="../js/select2.min.js"></script>
        <script src="../js/frontoffice/table-huasheng.js"></script>
        
   
	   <script>
	   
           document.getElementById("btnSearch").onclick = function () {
			  var jsonArg = {}; 
			  var str = document.getElementById("txtFuzzySearch").value
			  if(str.length!=0){
				  jsonArg.fuzzysearch = str;
			   }
			  var str = document.getElementById("txtRoom").value
			  if(str.length!=0){
				  jsonArg.room = str;
			   }
			   if(jQuery.isEmptyObject(jsonArg)){
			   	  //alert( "无查询条件" );
				  return
				}
			  tblGuestRetrieve( jsonArg );
			  
        	};
			
			function tblGuestRetrieve( jsonArg ){		
				//resultDataTable.fnClearTable(false);
                var exTable = jQuery('#tblGuest').DataTable({
                    responsive: true,
					"bDestroy":true,
					
                    "ajax": "ajax/objects1.txt",
					"fnServerParams": function ( aoData ) { 
					//aoData.push( {"id":"用户id","au":"授权号","ac":"retrieve1","json":{"gname": "张三", "sex": "男"}})
				    aoData.push( { "name": "uid", "value": "L01" } ,
						 		 { "name": "au", "value": "授权号" } ,
								 { "name": "fu", "value": "retrieve1" },
								 { "name": "jn", "value": JSON.stringify(jsonArg)} )					
						} ,
					
					//测试
                    "bLengthChange":false,
                    "bPaginate":false,
	            	"bFilter": false,
					"bSort":false,
					//
					
					"oLanguage": {                          //汉化
						"sLengthMenu": "每页显示 _MENU_ 条记录",
						"sZeroRecords": "没有检索到数据",
						"sInfo": "当前数据为从第 _START_ 到第 _END_ 条数据；总共有 _TOTAL_ 条记录",
						"sInfoEmtpy": "没有数据",
						"sProcessing": "正在加载数据...",
						"oPaginate": {
							"sFirst": "首页",
							"sPrevious": "前页",
							"sNext": "后页",
							"sLast": "尾页"
		            }},					
					"columnDefs":[
									{"targets": 0,
                                     "data": null,
                                     "render": function ( ) {
                                               return '<input type="checkbox" value="" name="tablechoice1" />';}
                                     },											
                                  ],
					
                    "columns": [

                        { "data": "" },
                        { "data": "gno" },
                        { "data": "gname" },
                        { "data": "room" },
                        { "data": "rate"},
                        { "data": "status" }
                    ],
                    "order": [[1, 'asc']],
				 
                });
				
			};
			
			document.getElementById("btnTest").onclick = function () {
				alert( selectRows() );					
			};
			
			$(document).ready(function () { 
				$(".table-huasheng").alterBgColor({ style: "4" }).find("th"); //可以链式操作  
			});				
			
			function selectRows (){
				var arrArg = new Array();
				var jsonData = {};
				var i = 0;
				$('#tblGuest tbody tr').each( function() {
					var chk=$(this).find('td').eq(0).find('input');
					if (chk.attr("checked")=="checked"){
						var arg={};
						var nTds = $('td', this);
						arg.sGno = $(nTds[1]).text();
						arg.sRoom = $(nTds[2]).text();
						arg.sGname = $(nTds[4]).text();
						
						arrArg[i] = arg;
						
						i++;
					}
				} );
				return JSON.stringify(arrArg);
			}	
	
       </script>
   
    </body>
    
    
    
    
</html>
