<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
        <meta name="description" content="">
        <meta name="author" content="">

        <title>Chain Responsive Bootstrap3 Admin</title>

        <link href="../css/style.default.css" rel="stylesheet">
        <link href="../css/select2.css" rel="stylesheet" />
        <link href="../css/style.datatables.css" rel="stylesheet">
        <link href="../css/dataTables.responsive.css" rel="stylesheet">
        
        <link href="../css/Table.css" rel="stylesheet">
        <link href="../css/Tablepage.css" rel="stylesheet">


        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
        <script src="js/html5shiv.js"></script>
        <script src="js/respond.min.js"></script>
        <![endif]-->
        
        <link href="../css/frontoffice/datatable.css" rel="stylesheet">
        <style>
	        .dataTable .selected{ background:rgb(217, 237, 247);}
			.form-inline .form-control {
				display: inline-block;
				width: 120px;
				vertical-align: middle;
				padding: 5px 10px;
			}
			.table-h{ height:500px;}
			
			.table-hover > tbody > tr:hover > td, .table-hover > tbody > tr:hover > th {
 				   background-color: #E4E7EA;
			}
			
        </style>
        
    </head>
    <body>
		<div class="contentpanel contentpanel-mediamanager">
            <hr>
      
            <div class="row">
                  <div class="col-sm-9">
                    <div class="table-responsive">
                    <table id="tblDict" class="table table-hover table-dark responsive table-huasheng">
                        <thead>
                            <tr>
                                <th ><input type="checkbox" id="chkAll" value="" /></th>
                                <th name ="status" >占用</th>
                                <th name ="room" >房号</th>
                                <th name ="rmtype" >房型</th>
                                <th name ="remark" >楼型</th>
                                <th name ="descript" >注释</th>
                                <th name ="hsk_status" >清扫</th>
                                <th name ="features" >特色</th>
                                <th name ="text1" >注意</th>
                                <th name ="hsk_pers" >人数</th>
                                <th name ="occ" >情况</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>                                
                   </div><!-- table-responsive -->
               </div><!-- col-sm-9 -->
            <div class="col-sm-4 col-md-3">
                <div class="row">
                    <div class="pull-right">
                        <div class="btn-toolbar">
                            <div class="btn-group">
                                <button id ="btn-search" type="reset" class="btn btn-info btn-sm"> 查询刷新 </button>
                            </div>
                            <div class="btn-group">
                                <button id ="btn-ok" type="reset" class="btn btn-primary btn-sm"> 选择确认 </button>
                                <button id ="btn-cancel" type="reset" class="btn btn-default btn-sm mr10"> 取消 </button>
                            </div>
                        </div><!-- btn-toolbar -->
                    </div>            	
                </div>
             
            
                <div class="mb5"></div>
                <div class="input-group">
                    <span class="input-group-addon">房号 </span>
                    <input type="text" class="form-control" id="txtFuzzySearch">
                </div><!-- input-group -->
                <div class="mb5"></div>
                <div class="input-group">
                    <span class="input-group-addon">日期 </span>
                    <input type="text" class="col-sm-5 form-control" id="txtRoom">            
                </div>
                <div class="mb5"></div>
                <div class="input-group">
                    <span class="input-group-addon">天数 </span>
                    <input type="text" class="form-control" id="txtGname">            
                </div>
                <div class="mb5"></div>
                <div class="input-group">
                    <span class="input-group-addon">房型 </span>
                    <input type="text" class="form-control" id="txtRoom"> 
                    <span class="input-group-btn">
                        <button type="button" class="btn btn-default"  onclick="rmtype_available()">选</button>
                    </span>
                </div>
                <div class="mb5"></div>
                <div class="input-group">
                    <span class="input-group-addon">特色 </span>
                    <input type="text" class="form-control" id="txtGname">            
                    <span class="input-group-btn">
                        <button type="button" class="btn btn-default"  onclick="rmtype_available()">选</button>
                    </span>
                </div>
                <div class="mb5"></div>
                    <input type="text" class="form-control" id="txtGname" placeholder="楼层...">            
                <div class="mb5"></div>
                    <input type="text" class="form-control" id="txtGname" placeholder="楼型...">            
                <div class="mb5"></div>
                    <input type="text" class="form-control" id="txtGname" placeholder="抵店时间...">            
                <div class="mb5"></div>
                
    
                <div class="panel-group" id="accordion">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4 class="panel-title">
                                <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
                                    筛选条件 #1
                                </a>
                            </h4>
                        </div>
                        <div id="collapseOne" class="panel-collapse collapse in">
                            <div class="panel-body">
                                <div class="input-group">
                                    <div class="ckbox ckbox-warning">
                                        <input type="checkbox" id="checkboxWarning"/>
                                        <label for="checkboxWarning">包括在住将要离店的房间</label>
                                    </div>
                                    <div class="ckbox ckbox-danger">
                                        <input type="checkbox" id="checkboxDanger" />
                                        <label for="checkboxDanger">包括将要离店或抵店的房间</label>
                                    </div>
                                    <div class="ckbox ckbox-primary">
                                        <input type="checkbox" value="1" id="checkboxPrimary"  />
                                        <label for="checkboxPrimary">只要清洁OK房</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><!-- panel -->
                    
                </div><!-- panel-group -->
                <br />
                            
            </div><!-- col-sm-4 -->                          
     	</div>
   	</div>        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <script src="../js/jquery-1.11.1.min.js"></script>
        <script src="../js/jquery-migrate-1.2.1.min.js"></script>
        <script src="../js/bootstrap.min.js"></script>
        
        <script src="../js/jquery.dataTables.min.js"></script>
        <script src="../js/dataTables.bootstrap.js"></script>
        <script src="../js/dataTables.responsive.js"></script>
        <script src="../js/select2.min.js"></script>
        <script src="../js/frontoffice/table-huasheng.js"></script>
		
		<script src="../js/frontoffice/cookies.js"></script>
        <script src="../js/frontoffice/jquery.contextmenu.r2.js"></script>        
        <script src="../js/frontoffice/artDialog.min.js"></script>
        <script src="../js/frontoffice/artDialog.plugins.min.js"></script>
        <script src="../js/frontoffice/jquery.artDialog.min.js"></script>
        
        <script src="../js/frontoffice/artDialog.source.js?skin=default" type="text/javascript"></script>
        <script src="../js/frontoffice/iframeTools.source.js" type="text/javascript"></script>        
      
   
	    <script>
		
			$(document).ready(function () {
				$(".table-huasheng").alterBgColor({ style: "4" }).find("rmtype"); //可以链式操作
				 
				var sTitle = $.parseJSON(art.dialog.data('aParameter')).title;
				var jsonArg = {};
				tblGuestRetrieve( jsonArg );
			});			
		
			function tblGuestRetrieve( jsonArg ){		
				//resultDataTable.fnClearTable(false);
                var exTable = jQuery('#tblDict').DataTable({
                    responsive: true,
					"bDestroy":true,
                    "fnInitComplete": function(oSettings) {
						jQuery('#tblDict').css("width","100%");
						jQuery('#tblDict_paginate').css("width","100%");
						add_parameter( art.dialog.data('aParameter') );   //添加列表选择初值
                    },					
					"bPaginate": true, //翻页功能
					"bLengthChange": true, //改变每页显示数据数量
					"bFilter": true, //过滤功能
					"bSort": false, //排序功能
					"bInfo": true,//页脚信息
					"bAutoWidth": true,//自动宽度	
					"oLanguage": {
					  "sSearch": "搜索:",
					  "sLengthMenu": "每页显示 _MENU_ 条记录",
					  "sZeroRecords": "Nothing found - 没有记录",
					  "sInfo": "显示第  _START_ 条到第  _END_ 条记录,一共  _TOTAL_ 条记录",
					  "sInfoEmpty": "显示0条记录",
					  "oPaginate": {
					   "sPrevious": " 上一页 ",
					   "sNext":     " 下一页 ",
					   }
					  },									
					
                    "ajax": "data/roomssearch.txt",
					"fnServerParams": function ( aoData ) { 
					//aoData.push( {"id":"用户id","au":"授权号","ac":"retrieve1","json":{"gname": "张三", "sex": "男"}})
				    aoData.push( { "name": "uid", "value": "L01" } ,
						 		 { "name": "au", "value": "授权号" } ,
								 { "name": "fu", "value": "retrieve1" },
								 { "name": "jn", "value": JSON.stringify(jsonArg)} )					
						} ,
					"columnDefs":[
									{"targets": 0,
                                     "data": null,
                                     "render": function ( ) {
                                               return '<input type="checkbox" value="" name="tablechoice1" />';}
                                     },											
                                  ],
					
                    "columns": [

                        { "data": "" },
                        { "data": "status" },
                        { "data": "room" },
                        { "data": "rmtype" },
                        { "data": "remark" },
                        { "data": "descript" },
                        { "data": "hsk_status" },
                        { "data": "features" },
                        { "data": "text1" },
                        { "data": "hsk_pers" },
                        { "data": "hsk_pers" }


                    ],
                    "order": [[1, 'asc']],
				 
                });

			};
			

			function selectRows (){
				var sArg = "";
				var arrArg = new Array();
				var jsonData = {};
				var i = 0;
				$('#tblDict tbody tr').each( function() {
					var chk=$(this).find('td').eq(0).find('input');
					if (chk.attr("checked")=="checked"){
						var arg={};
						var nTds = $('td', this);
						arg.sCode = $(nTds[1]).text();
						arg.sText = $(nTds[2]).text();
						
						arrArg[i] = arg;
						
						sArg = $(nTds[2]).text();
						i++;
						return false
					}
				} );
				return sArg;
			}	
			
			// 返回数据给A页面
			document.getElementById('btn-ok').onclick = function () {
				art.dialog.data('bParameter','{"ok":"1","arg":"' + selectRows () +'"}' );// 存储数据
				art.dialog.close();
			};

			document.getElementById('btn-cancel').onclick = function () {
				art.dialog.data('bParameter','{"ok":"0"}');// 取消
				art.dialog.close();
			};

			function add_parameter(sParameter){
				//添加列表选择初值
				var sArg =  ',' + $.parseJSON(sParameter).arg + ',';
				
				var t = $('#tblDict tbody tr');

				$('#tblDict tbody tr').each( function() {
					var this_tr = $(this);    //本行的tr
					var chk=this_tr.find('td').eq(0).find('input');
					var nTds = $('td', this);
					if(sArg.indexOf($(nTds[2]).text()+',') > 0){
						chk.attr("checked",true);
						this_tr.addClass("selected");   
					}
				} );
			}

       </script>
       
    </body>
</html>
